(()=>{var t={35(t){var e=t=>{var e=new Date(t);return`${e.getFullYear()}-${e.getMonth()+1}-${e.getDate()}`};t.exports={show_post_list:t=>{var a=get_option("nv_home_url","");return'<ul class="article-list">'+t.data.map(t=>{var n=get_post_meta(t.id,"_nv_thumbnail");return`<li><a href="${a}/${t.slug}">\n\t\t\t<span class="article-info">\n\t\t\t\t<h4>${t.title}</h4>\n\t\t\t\t<span class="date">${e(t.modified_time)}</span>\n\t\t\t</span>\n\t\t\t${n?`<img src='${n}' />`:""}\n\t\t\t</a></li>`}).join("")+"</ul>"},show_category_menu:()=>{var t=get_option("nv_home_url",""),e=query_terms({taxonomy:"category"}).map(e=>`<li><a href="${t}/category/${e.slug}">${e.name}</a></li>`).join("");return`<nav class="category-nav"><ul>\n\t\t<li><a href="${t}/" rel="home">首页</a></li>\n\t\t<li><a href="${t}/articles">全部文章</a></li>\n\t\t${e}\n\t\t</ul></nav>`},parse_image_url:t=>t?"http"==t.substr(0,4)||"//"==t.substr(0,2)?t:get_option("nv_home_url","")+t:t,parse_date:e}},144(t,e,a){var{parse_image_url:n,parse_date:r}=a(35),s=({title:t,description:e,image:a})=>{nv_enqueue_head(`\n\t\t<title>${t}</title>\n\t\t<meta itemprop="name" content="${t}" />\n\t\t`),nv_enqueue_head(`\n\t\t<meta description="${e}" />\n\t\t<meta name="description" itemprop="description" content="${e}" />\n\t\t`);var r=n(get_option("base_logo_url"));nv_enqueue_head(`\n\t\t<meta itemprop="image" content="${a||r}" />\n\t\t`),r&&nv_enqueue_head(`\n\t\t<link rel="shortcut icon" href="${r}" sizes="32x32">\n\t\t`)};add_action("nv_head",(t,e)=>{nv_enqueue_head('\n\t\t<meta charset="utf-8" />\n\t\t<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no,viewport-fit=cover" />\n\t\t')},-1),add_action("nv_head",(t,e)=>{nv_enqueue_style("/srcs/ssr-style.css","ssr-style",1)},999),add_action("nv_head",(t,e)=>{if("home"===e.name){var a=get_option("nv_site_name","nvPress"),n=esc_html(strip_tags(a)),r=esc_html(strip_tags(`欢迎访问 ${a}，${get_option("nv_site_description","")}`));s({title:n,description:r})}}),add_action("nv_head",(t,e)=>{if(["articles","articles_paged"].includes(e.name)){var a=get_option("nv_site_name","nvPress"),n=`全部文章${(parseInt(t.params.page)||1)>1?` - 第${t.params.page}页`:""} - ${a}`,r=esc_html(strip_tags(`欢迎访问 ${a}，您当前浏览的是全站文章列表`));s({title:n,description:r})}}),add_action("nv_head",(t,e)=>{if(["post","post_comment_paged"].includes(e.name)){var a=encodeURIComponent(decodeURIComponent(t.params.post_slug)),o=get_post(a);if(is_nv_error(o))return e.status=404,void i();if("publish"!==o.status||o.modified_time>(new Date).getTime())return e.status=404,void i();var p=get_option("nv_site_name","nvPress"),_=`${esc_html(strip_tags(o.title))} - ${p}`,m=esc_html(strip_tags(o.excerpt?o.excerpt:o.content.blocks.filter(t=>"paragraph"==t.type).map(t=>t.data.text).join("").substr(0,160))),l=get_post_meta(o.id,"_nv_thumbnail");s({title:_,description:m,image:l});var d=get_option("nv_home_url","");nv_enqueue_head(`\n\t\t<meta name="Author" content="${p}" />\n\t\t<meta name="Owner" content="${p}" />\n\t\t<meta property="og:type" content="article"/>\n\t\t<meta property="og:locale" content="zh-CN"/>\n\t\t<meta property="og:site_name" content="${p}"/>\n\t\t<meta property="og:title" content="${o.title}"/>\n\t\t<meta property="og:description" content="${m}"/>\n\t\t<meta property="og:url" content="${d+"/"+o.slug}"/>\n\t\t<meta property="og:image" content="${n(l)}"/>\n\t\t<meta property="og:release_date" content="${r(o.created_time)}"/>\n\t\t<meta property="article:author" content="${p}"/>\n\t\t<meta property="article:published_first" content="${p},${d+"/"+o.slug}"/>\n\t\t<link rel="canonical" href="${d+"/"+o.slug}" />\n\t`)}}),add_action("nv_head",(t,e)=>{if(["term","term_paged"].includes(e.name)){var a=t.params.term_slug,n=t.params.taxonomy,r=parseInt(t.params.page)||1,o=term_exists(a,n);if(!o)return e.status=404,void i();var p=nvdb.terms.find(t=>t.id==o)[0],_=get_option("nv_site_name","nvPress"),m=`${p.name}${r>1?` - 第${t.params.page}页`:""} - ${_}`,l=esc_html(strip_tags(`欢迎光临${_}，您当前浏览的分类是：${p.name}`));s({title:m,description:l})}});var i=()=>{var t=get_option("nv_site_name","nvPress"),e=`404 - ${t}`,a=esc_html(strip_tags(`欢迎访问 ${t}，${get_option("nv_site_description","")}`));s({title:e,description:a})};add_action("nv_head",(t,e)=>{"404"===e.name&&i()})},412(t,e,a){a(928),a(896);global.base_lite_post=t=>({id:t.id,title:t.title,slug:t.slug,modified_time:t.modified_time,views:get_post_meta(t.id,"views")||0,likes:get_post_meta(t.id,"likes")||0,comments:t.comment_count,thumbnail:get_the_post_thumbnail_url(t.id),categories:nv_get_object_terms(t.id,"category").map(t=>t.name),tags:nv_get_object_terms(t.id,"tag").map(t=>t.name),metas:get_post_meta(t.id)}),register_rest_route("base","post-list",{methods:"post",callback(t,e){var{taxonomy:a,term_slug:n,current_page:r}=t,s={post_type:"article",status:"publish",posts_per_page:12,current_page:r};a&&n&&(s.tax_query={relation:"AND",opts:[{taxonomy:a,terms:Array.isArray(n)?n:[n],operator:"IN"}]});var i=query_posts(s);return{term_names:n?get_terms({taxonomy:a,include:Array.isArray(n)?n:[n]}).map(t=>t.name):[],articles:i.data.map(t=>base_lite_post(t)),pagination:i.pagination}}})},606(t,e,a){var{show_post_list:n,show_category_menu:r,parse_image_url:s}=a(35),i=()=>`<footer>\n\t\t\t\t${get_option("base_copyright","三禾木木 - nvPress")}\n\t\t\t</footer>`;add_action("async:nv_render:home",(t,{echo:e,req:a,route:s})=>{e(`\n\t\t<div class="home ssr-body">\n\t\t\t<div class="banner">\n\t\t\t\t<h1>${get_option("nv_site_name","nvPress")}</h1>\n\t\t\t\t<p>${get_option("nv_site_description","")}</p>\n\t\t\t\t${r()}\n\t\t\t</div>\n\t\t\t<div class="wrapper">\n\t\t\t\t<div class="main">\n\t\t\t\t\t<h3>近期文章</h3>\n\t\t\t\t\t${n(query_posts({post_type:"article"}))}\n\t\t\t\t</div>\n\t\t\t\t<aside>\n\t\t\t\t\t<h4>随机文章</h4>\n\t\t\t\t\t${n(query_posts({post_type:"article",orderby:"rand"}))}\n\t\t\t\t</aside>\n\t\t\t</div>\n\t\t\t${i()}\n\t\t</div>\n\t\t`),t()});var o=(t,{echo:e,req:a,route:s})=>{var o=parseInt(a.params.page)||1,p=query_posts({post_type:"article",status:"publish",current_page:o,posts_per_page:12}),{posts_per_page:_,total:m}=p.pagination;e(`\n\t\t<div class="articles ssr-body">\n\t\t\t<div class="banner">\n\t\t\t\t<h1>全部文章</h1>\n\t\t\t\t<p>您当前浏览的是全站文章列表，目前站内共${m}篇文章，每页${_}篇</p>\n\t\t\t\t${r()}\n\t\t\t</div>\n\t\t\t<div class="wrapper">\n\t\t\t\t<div class="main">\n\t\t\t\t${n(p)}\n\t\t\t\t${(({posts_per_page:t,total:e,current_page:a})=>{var n=get_option("nv_home_url",""),r="";return a>1&&(r+=2==a?`<a rel="prev" href="${n}/articles">上一页</a>`:`<a rel="prev" href="${n}/articles/page/${a-1}">上一页</a>`),a<Math.ceil(e/t)&&(r+=`<a rel="next" href="${n}/articles/page/${a+1}">下一页</a>`),r})({posts_per_page:_,total:m,current_page:o})}\n\t\t\t\t</div>\n\t\t\t\t<aside>\n\t\t\t\t\t<h4>随机文章</h4>\n\t\t\t\t\t${n(query_posts({post_type:"article",orderby:"rand"}))}\n\t\t\t\t</aside>\n\t\t\t</div>\n\t\t\t${i()}\n\t\t</div>\n\t\t`),t()};add_action("async:nv_render:articles",o),add_action("async:nv_render:articles_paged",o);var p=(t,{echo:e,req:a,route:s})=>{if(["term","term_paged"].includes(s.name)){var o=a.params.term_slug,p=a.params.taxonomy,_=parseInt(a.params.page)||1,l=term_exists(o,p);if(!l)return s.status=404,void m(t,{echo:e,req:a,route:s});var d=nvdb.terms.find(t=>t.id==l)[0],c=query_posts({post_type:"article",status:"publish",tax_query:{opts:[{taxonomy:p,terms:[l]}]},current_page:_,posts_per_page:12}),{posts_per_page:u,total:g}=c.pagination;e(`\n\t\t<div class="term ssr-body">\n\t\t\t<div class="banner">\n\t\t\t\t<h1>文章分类：${d.name}</h1>\n\t\t\t\t<p>您当前浏览的分类是：${d.name}，该分类共${g}篇文章，每页${u}篇</p>\n\t\t\t\t${r()}\n\t\t\t</div>\n\t\t\t<div class="wrapper">\n\t\t\t\t<div class="main">\n\t\t\t\t${n(c)}\n\t\t\t\t${(({posts_per_page:t,total:e,current_page:a})=>{var n=get_option("nv_home_url",""),r="";return a>1&&(r+=2==a?`<a rel="prev" href="${n}/${p}/${o}">上一页</a>`:`<a rel="prev" href="${n}/${p}/${o}/page/${a-1}">上一页</a>`),a<Math.ceil(e/t)&&(r+=`<a rel="next" href="${n}/${p}/${o}/page/${a+1}">下一页</a>`),r})({posts_per_page:u,total:g,current_page:_})}\n\t\t\t\t</div>\n\t\t\t\t<aside>\n\t\t\t\t\t<h4>最新文章</h4>\n\t\t\t\t\t${n(query_posts({post_type:"article"}))}\n\t\t\t\t</aside>\n\t\t\t</div>\n\t\t\t${i()}\n\t\t</div>\n\t\t`),t()}};add_action("async:nv_render:term",p),add_action("async:nv_render:term_paged",p);var _=(t,{echo:e,req:a,route:n})=>{var o=encodeURIComponent(decodeURIComponent(a.params.post_slug)),p=get_post(o);if(is_nv_error(p))return n.status=404,void m(t,{echo:e,req:a,route:n});if("publish"!==p.status||p.modified_time>(new Date).getTime())return n.status=404,void m(t,{echo:e,req:a,route:n});var _=esc_html(strip_tags(p.excerpt?p.excerpt:p.content.blocks.filter(t=>"paragraph"==t.type).map(t=>t.data.text).join("").substr(0,160))),l=get_option("nv_home_url",""),d=get_post_meta(p.id,"_nv_thumbnail"),c=d?`<img src="${s(d)}" alt="thumbnail" style="float:right;width:256px;" />`:"",u={};(t=>{var e=t.id,a=get_taxonomies(t.post_type),n={};a.forEach(t=>{var a=nv_get_object_terms(e,t.taxonomy);n[t.taxonomy]=a}),u=n})(p);async_get_the_content(p).then(a=>{e(`\n\t\t\t<div class="term ssr-body">\n\t\t\t\t<div class="banner">\n\t\t\t\t\t<h1>${p.title}</h1>\n\t\t\t\t\t<p>${_}</p>\n\t\t\t\t\t${r()}\n\t\t\t\t</div>\n\t\t\t\t<div class="wrapper">\n\t\t\t\t\t<div class="main">\n\t\t\t\t\t\t<article class="post-wrapper">\n\t\t\t\t\t\t${c}\n\t\t\t\t\t\t${a}\n\t\t\t\t\t\t</article>\n\t\t\t\t\t</div>\n\t\t\t\t\t<aside>\n\t\t\t\t\t\t<h4>标签与分类</h4>\n\t\t\t\t\t\t<ul class="term-list">${(t=>{var e="";return u.category&&u.category.map(a=>{e+=`<li><a href="${t}/category/${a.slug}">${a.name}</a></li>`}),u.tag&&u.tag.map(a=>{e+=`<li><a href="${t}/tag/${a.slug}">${a.name}</a></li>`}),e})(l)}</ul>\n\t\t\t\t\t\t<h4>相关文章</h4>\n\t\t\t\t\t\t<ul class="article-list">${((t,e)=>{if(!u.category||!u.tag)return"";var a=t.id,n=u.category.map(t=>t.id),r=u.tag.map(t=>t.id);return query_posts({post_type:"article",status:"publish",post_not_in:[a],tax_query:{relation:"OR",opts:[{taxonomy:"category",terms:n,operator:"IN"},{taxonomy:"tag",terms:r,operator:"IN"}]},orderby:"rand",posts_per_page:4}).data.map(t=>{var a=get_post_meta(t.id,"_nv_thumbnail");return`<li><a href="${e}/${t.slug}"><h5>${t.title}</h5> ${a?`<img src='${s(a)}' />`:""}</a></li>`}).join("")})(p,l)}</ul>\n\t\t\t\t\t</aside>\n\t\t\t\t</div>\n\t\t\t\t${i()}\n\t\t\t</div>\n\t\t\t`),t()})};add_action("async:nv_render:post",_),add_action("async:nv_render:post_comment_paged",_);var m=(t,{echo:e,req:a,route:n})=>{e(`<div class="four04 ssr-body">\n\t\t\t<div class="banner">\n\t\t\t\t<h1>404</h1>\n\t\t\t\t<p>404 not found</p>\n\t\t\t\t${r()}\n\t\t\t</div>\n\t\t\t<div class="wrapper">\n\t\t\t\t<p>您访问的页面不存在</p>\n\t\t\t</div>\n\t\t\t${i()}\n\t\t</div>`),t()};add_action("async:nv_render:404",m);var l=0,d="",c=()=>{var t=(new Date).getTime();if(t-l>864e5){l=t,d="";var e=query_posts({post_type:"article",status:"publish",posts_per_page:999}),a=get_option("nv_home_url","");e.data.forEach(t=>{var e,n,r,s;d+="<url>",d+=`<loc>${a}/${t.slug}</loc>`,d+=`<lastmod>${e=t.modified_time,n=new Date(e),r=String(n.getDate()).padStart(2,"0"),s=String(n.getMonth()+1).padStart(2,"0"),`${n.getFullYear()}-${s}-${r}`}</lastmod>`,d+="<changefreq>weekly</changefreq>",d+="<priority>1.0</priority>",d+="</url>"})}return d};add_action("async:nv_render:sitemap",(t,{echo:e,req:a,route:n})=>{e('<?xml version="1.0" encoding="utf-8"?>'),e('<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">'),e(c()),e("</urlset>"),t()})},776(t,e,a){a(928);var n=a(896);nv_render_assistant({rendering_mode:"SSR",root_folder:get_theme_path("./web/"),template:{head:(t,e)=>`<!DOCTYPE html><html lang="zh-cn"><head>${nv_head(t,e)}</head><body><div id="app">`,foot:(t,e)=>"</div></body></html>"},routes:[{name:"home",path:"/"},{name:"sitemap",path:"/sitemap.xml",type:"text/xml"},{name:"articles",path:"/articles"},{name:"articles_paged",path:"/articles/:page"},{name:"post",path:"/:post_slug"},{name:"post_comment_paged",path:"/:post_slug/comment-page-:comment_page"},{name:"term",path:"/:taxonomy/:term_slug"},{name:"term_paged",path:"/:taxonomy/:term_slug/:page"},{name:"404",path:"*",status:404}]});var r=n.readFileSync(get_theme_path("./web/application.html"),{encoding:"utf8"});add_action("nv_head",()=>{nv_enqueue_head(r)},99),a(144),a(606)},896(t){"use strict";t.exports=require("fs")},928(t){"use strict";t.exports=require("path")}},e={};function a(n){var r=e[n];if(void 0!==r)return r.exports;var s=e[n]={exports:{}};return t[n](s,s.exports,a),s.exports}a(928),a(896);set_frontstage_rendering_mode("SSR");add_action("init_express",()=>{register_static_url("/srcs",get_theme_path("./srcs/"))}),register_nav_menus({topNav:"顶部菜单",catNav:"分类菜单"}),add_submenu_page({parent_slug:"appearance",page_title:"主题设置",menu_title:"主题设置",menu_slug:"theme-settings",power:10,position:9,component_url:"/srcs/page-settings/index.vue"}),add_meta_box({post_types:["article"],meta_box_slug:"article-metabox-likes",content:{title:"点赞量",items:[{label:"",type:"InputNumber",meta_key:"likes",config:{min:0,defaultValue:0}}]}}),add_meta_box({post_types:["article"],meta_box_slug:"article-metabox-views",content:{title:"阅读量",items:[{label:"",type:"InputNumber",meta_key:"views",config:{min:0,defaultValue:0}}]}}),add_post_type_support("page","thumbnail"),register_rest_route("base","site-metas",{methods:"post",callback:(t,e)=>({...get_options(["nv_site_name","nv_site_description","nv_date_format","nv_time_format","require_name_email","enable_comment","comment_registration","base_logo_url","base_copyright"])})}),a(412),a(776),module.exports={}.default})();